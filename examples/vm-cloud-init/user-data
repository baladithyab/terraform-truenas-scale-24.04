#cloud-config
hostname: ubuntu-static
manage_etc_hosts: true
chpasswd:
  expire: false
users:
  - name: ubuntu
    sudo: ALL=(ALL) NOPASSWD:ALL
    groups: users, admin
    home: /home/ubuntu
    shell: /bin/bash
    lock_passwd: false
    ssh_authorized_keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC3ExamplePublicKeyForDemostrationOnly
packages:
  - qemu-guest-agent
  - net-tools
  - curl
  - wget
runcmd:
  - systemctl enable --now qemu-guest-agent
  - echo "VM initialized with cloud-init" > /etc/cloud-init-done
write_files:
  - path: /etc/netplan/01-netcfg.yaml
    content: |
      network:
        version: 2
        ethernets:
          eth0:
            dhcp4: no
            addresses: [192.168.1.100/24]
            gateway4: 192.168.1.1
            nameservers:
              addresses: [8.8.8.8, 8.8.4.4]
  - path: /etc/motd
    content: |
      Welcome to Ubuntu Server with Static IP Configuration
      This VM was configured using Terraform and cloud-init
      IP Address: 192.168.1.100
      Gateway: 192.168.1.1
      DNS: 8.8.8.8, 8.8.4.4
final_message: "Cloud-init completed successfully. System is ready for use."